<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§¤ì¼ ì˜ì–´ í•™ìŠµ</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <h1 class="text-2xl font-bold mb-6">ë§¤ì¼ ì˜ì–´ í•™ìŠµ âœ¨</h1>
            
            <div class="flex gap-2 bg-gray-100 p-1 rounded-xl mb-6">
                <button onclick="showTab('learn')" id="tab-learn" class="flex-1 py-2 rounded-lg font-medium bg-white text-indigo-600">ğŸ“– í•™ìŠµ</button>
                <button onclick="showTab('manage')" id="tab-manage" class="flex-1 py-2 rounded-lg font-medium text-gray-600">â• ë‹¨ì–´ê´€ë¦¬</button>
                <button onclick="showTab('settings')" id="tab-settings" class="flex-1 py-2 rounded-lg font-medium text-gray-600">âš™ï¸ ì„¤ì •</button>
            </div>

            <div id="content-learn">
                <div class="mb-4">
                    <p class="text-lg font-bold" id="today-date"></p>
                </div>
                <button onclick="sendToTelegram()" class="w-full py-3 bg-blue-500 text-white rounded-lg font-bold mb-4 hover:bg-blue-600">
                    ğŸ“± í…”ë ˆê·¸ë¨ ì „ì†¡
                </button>
                <div id="word-list" class="space-y-4"></div>
            </div>

            <div id="content-manage" class="hidden">
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <h3 class="font-bold mb-3">ğŸ“ ì—‘ì…€ì—ì„œ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê¸° (ì¶”ì²œ!)</h3>
                    <p class="text-sm text-gray-700 mb-2">âœ… ì—‘ì…€ì—ì„œ ì…€ ì„ íƒ â†’ Ctrl+C ë³µì‚¬ â†’ ì•„ë˜ Ctrl+V ë¶™ì—¬ë„£ê¸°</p>
                    <div class="bg-white p-3 rounded mb-3 border-l-4 border-green-500">
                        <div class="text-xs text-gray-500 mb-2">ğŸ’¡ ì—‘ì…€ í˜•ì‹ (ì²« ì¤„ì€ í—¤ë”):</div>
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="border-b">
                                    <th class="text-left p-1 bg-gray-50">ì˜ì–´</th>
                                    <th class="text-left p-1 bg-gray-50">í•œê¸€</th>
                                    <th class="text-left p-1 bg-gray-50">ìœ ì˜ì–´</th>
                                    <th class="text-left p-1 bg-gray-50">ì˜ˆë¬¸</th>
                                    <th class="text-left p-1 bg-gray-50">ë¹„ê³ </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="text-gray-600">
                                    <td class="p-1">Enclose</td>
                                    <td class="p-1">ì²¨ë¶€í•˜ë‹¤</td>
                                    <td class="p-1">Attach</td>
                                    <td class="p-1">I'm delighted to enclose</td>
                                    <td class="p-1"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <textarea id="bulk-text" rows="8" placeholder="ì—¬ê¸°ì— ì—‘ì…€ ë°ì´í„°ë¥¼ Ctrl+Vë¡œ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”!&#10;&#10;ì—‘ì…€ì—ì„œ:&#10;1. ë°ì´í„° ì…€ ì„ íƒ (í—¤ë” í¬í•¨)&#10;2. Ctrl+C ë³µì‚¬&#10;3. ì—¬ê¸°ì— Ctrl+V ë¶™ì—¬ë„£ê¸°" class="w-full p-3 border-2 border-dashed border-green-300 rounded font-mono text-sm focus:border-green-500 focus:outline-none"></textarea>
                    <button onclick="bulkAdd()" class="w-full py-2 bg-green-600 text-white rounded hover:bg-green-700 font-bold">
                        âœ… ì¼ê´„ ì¶”ê°€ (í˜„ì¬ <span id="vocab-count-1">0</span>ê°œ)
                    </button>
                </div>

                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                    <h3 class="font-bold mb-3">ğŸ“¤ CSV íŒŒì¼ ì—…ë¡œë“œ</h3>
                    <p class="text-sm text-gray-700 mb-2">ì—‘ì…€ì—ì„œ CSV UTF-8ë¡œ ì €ì¥í•œ íŒŒì¼:</p>
                    <div class="bg-white p-3 rounded mb-3 border-l-4 border-blue-500">
                        <div class="text-xs text-gray-500 mb-2">ğŸ’¡ CSV í˜•ì‹ (íƒ­ìœ¼ë¡œ êµ¬ë¶„):</div>
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="border-b">
                                    <th class="text-left p-1 bg-gray-50">ì˜ì–´</th>
                                    <th class="text-left p-1 bg-gray-50">í•œê¸€</th>
                                    <th class="text-left p-1 bg-gray-50">ìœ ì˜ì–´</th>
                                    <th class="text-left p-1 bg-gray-50">ì˜ˆë¬¸</th>
                                    <th class="text-left p-1 bg-gray-50">ë¹„ê³ </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="text-gray-600">
                                    <td class="p-1">Enclose</td>
                                    <td class="p-1">ì²¨ë¶€í•˜ë‹¤</td>
                                    <td class="p-1">Attach</td>
                                    <td class="p-1">I'm delighted...</td>
                                    <td class="p-1"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <input type="file" id="file-upload" accept=".csv,.txt" class="w-full p-2 border rounded mb-2 bg-white">
                    <button onclick="uploadFile()" class="w-full py-2 bg-blue-600 text-white rounded hover:bg-blue-700">ğŸ“¤ íŒŒì¼ ì—…ë¡œë“œ</button>
                </div>

                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-6">
                    <h3 class="font-bold mb-3">ğŸ’¾ GitHub ìë™í™”ìš©</h3>
                    <p class="text-sm text-gray-700 mb-3">ë§¤ì¼ ì˜¤ì „ 7ì‹œ ìë™ ì „ì†¡ì„ ìœ„í•´ words.json ë‹¤ìš´ë¡œë“œ</p>
                    <button onclick="exportForGitHub()" class="w-full py-2 bg-purple-600 text-white rounded hover:bg-purple-700">
                        ğŸ“¥ words.json ë‹¤ìš´ë¡œë“œ (í˜„ì¬ <span id="vocab-count-2">0</span>ê°œ)
                    </button>
                </div>

                <h2 class="font-bold mb-4">ë‹¨ì–´ í•˜ë‚˜ì”© ì¶”ê°€</h2>
                <div class="space-y-3">
                    <input type="text" id="new-english" placeholder="ì˜ì–´ í‘œí˜„ (ì˜ˆ: Enclose)" class="w-full p-2 border rounded">
                    <input type="text" id="new-korean" placeholder="í•œê¸€ ëœ» (ì˜ˆ: ì²¨ë¶€í•˜ë‹¤)" class="w-full p-2 border rounded">
                    <input type="text" id="new-synonyms" placeholder="ìœ ì˜ì–´ (ì˜ˆ: Attach, Include)" class="w-full p-2 border rounded">
                    <input type="text" id="new-example" placeholder="ì˜ˆë¬¸ (ì˜ˆ: I'm delighted to enclose)" class="w-full p-2 border rounded">
                    <button onclick="addWord()" class="w-full py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">ì¶”ê°€í•˜ê¸°</button>
                </div>
                <div id="all-words" class="mt-6"></div>
            </div>

            <div id="content-settings" class="hidden">
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                    <p class="font-bold mb-2">ğŸ“– ì„¤ì • ê°€ì´ë“œ</p>
                    <ol class="text-sm space-y-1 list-decimal list-inside">
                        <li>@BotFatherì—ì„œ ë´‡ ë§Œë“¤ê¸°</li>
                        <li>@RawDataBotì—ì„œ Chat ID í™•ì¸</li>
                        <li>ë´‡ì—ê²Œ /start ë³´ë‚´ê¸° (í•„ìˆ˜!)</li>
                    </ol>
                </div>
                <div class="space-y-4">
                    <div>
                        <label class="block mb-2 font-medium">ë´‡ í† í°</label>
                        <input type="text" id="telegram-token" placeholder="123456:ABC..." class="w-full p-2 border rounded font-mono text-sm">
                    </div>
                    <div>
                        <label class="block mb-2 font-medium">Chat ID</label>
                        <input type="text" id="telegram-chatid" placeholder="987654321" class="w-full p-2 border rounded font-mono text-sm">
                    </div>
                    <button onclick="saveSettings()" class="w-full py-3 bg-indigo-600 text-white rounded hover:bg-indigo-700">ğŸ’¾ ì €ì¥</button>
                </div>
            </div>
        </div>
    </div>

<script>
let vocabulary = [
    { korean: "ì²¨ë¶€í•˜ë‹¤", english: "Enclose", difficulty: "basic", example: "I'm delighted to enclose our latest catalogue", synonyms: ["Attach"] },
    { korean: "ë¬¸ì˜", english: "Enquiry", difficulty: "basic", example: "This email is regarding your enquiry", synonyms: ["Inquiry"] }
];

function uploadFile() {
    const fileInput = document.getElementById('file-upload');
    const file = fileInput.files[0];
    if (!file) {
        alert('âš ï¸ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”!');
        return;
    }
    
    const reader = new FileReader();
    reader.onload = function(e) {
        const text = e.target.result;
        const lines = text.split('\n');
        let added = 0;
        let skippedHeader = false;
        
        lines.forEach((line, index) => {
            if (!line.trim()) return;
            
            // í—¤ë” í–‰ ê±´ë„ˆë›°ê¸°
            if (!skippedHeader && (line.includes('ì˜ì–´') || line.includes('í•œê¸€') || line.includes('ë‹¨ì–´') || line.includes('English'))) {
                skippedHeader = true;
                return;
            }
            
            // íƒ­ìœ¼ë¡œ êµ¬ë¶„ëœ ë°ì´í„° íŒŒì‹±
            const parts = line.split('\t');
            
            if (parts.length >= 4) {
                const english = parts[0].trim();
                const korean = parts[1].trim();
                const synonymsText = parts[2].trim();
                const example = parts[3].trim();
                
                if (korean && english && example) {
                    const synonyms = synonymsText ? synonymsText.split(',').map(s => s.trim()).filter(s => s) : [];
                    vocabulary.push({ korean, english, example, difficulty: 'basic', synonyms });
                    added++;
                }
            }
        });
        
        if (added === 0) {
            alert('âš ï¸ ì¶”ê°€ëœ ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤!\n\nâœ… í™•ì¸ì‚¬í•­:\n1. CSV íŒŒì¼ì´ íƒ­ìœ¼ë¡œ êµ¬ë¶„ë˜ì–´ ìˆë‚˜ìš”?\n2. ì˜ì–´/í•œê¸€/ì˜ˆë¬¸ ì—´ì´ ëª¨ë‘ ìˆë‚˜ìš”?\n3. ì²« ì¤„ì´ í—¤ë”ì¸ê°€ìš”?');
            return;
        }
        
        localStorage.setItem('vocabulary', JSON.stringify(vocabulary));
        alert('âœ… ' + added + 'ê°œ ë‹¨ì–´ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
        updateVocabCount();
        renderAllWords();
        renderWords();
        fileInput.value = '';
    };
    reader.readAsText(file, 'UTF-8');
}

function bulkAdd() {
    const text = document.getElementById('bulk-text').value;
    if (!text.trim()) {
        alert('âš ï¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”!');
        return;
    }
    
    const lines = text.split('\n');
    let added = 0;
    let skippedHeader = false;
    
    lines.forEach((line, index) => {
        if (!line.trim()) return;
        
        // í—¤ë” í–‰ ê±´ë„ˆë›°ê¸°
        if (!skippedHeader && (line.includes('ì˜ì–´') || line.includes('í•œê¸€') || line.includes('ë‹¨ì–´') || line.includes('English'))) {
            skippedHeader = true;
            return;
        }
        
        // íƒ­ìœ¼ë¡œ êµ¬ë¶„ëœ ë°ì´í„° íŒŒì‹±
        const parts = line.split('\t');
        
        if (parts.length >= 4) {
            const english = parts[0].trim();
            const korean = parts[1].trim();
            const synonymsText = parts[2].trim();
            const example = parts[3].trim();
            
            if (korean && english && example) {
                const synonyms = synonymsText ? synonymsText.split(',').map(s => s.trim()).filter(s => s) : [];
                vocabulary.push({ korean, english, example, difficulty: 'basic', synonyms });
                added++;
            }
        }
    });
    
    if (added === 0) {
        alert('âš ï¸ ì¶”ê°€ëœ ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤!\n\nâœ… í™•ì¸ì‚¬í•­:\n1. ì—‘ì…€ì—ì„œ Ctrl+Cë¡œ ë³µì‚¬í–ˆë‚˜ìš”?\n2. ì˜ì–´/í•œê¸€/ì˜ˆë¬¸ ì—´ì´ ëª¨ë‘ ìˆë‚˜ìš”?\n3. ì²« ì¤„ì´ í—¤ë”ì¸ê°€ìš”?');
        return;
    }
    
    localStorage.setItem('vocabulary', JSON.stringify(vocabulary));
    alert('âœ… ' + added + 'ê°œ ë‹¨ì–´ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
    document.getElementById('bulk-text').value = '';
    updateVocabCount();
    renderAllWords();
    renderWords();
}

function exportForGitHub() {
    if (vocabulary.length === 0) {
        alert('âš ï¸ ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤!');
        return;
    }
    
    const data = JSON.stringify(vocabulary, null, 2);
    const blob = new Blob([data], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'words.json';
    a.click();
    
    alert('âœ… words.json íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!\n\në‹¤ìŒ ë‹¨ê³„:\n1. GitHub ì €ì¥ì†Œ ì—´ê¸°\n2. Add file â†’ Upload files\n3. words.json ì—…ë¡œë“œ');
}

function deleteAllWords() {
    if (confirm('âš ï¸ ì •ë§ ì „ì²´ ë‹¨ì–´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!')) {
        if (confirm('âš ï¸âš ï¸ ë§ˆì§€ë§‰ í™•ì¸: ì •ë§ ' + vocabulary.length + 'ê°œ ë‹¨ì–´ë¥¼ ëª¨ë‘ ì‚­ì œí• ê¹Œìš”?')) {
            vocabulary = [];
            localStorage.setItem('vocabulary', JSON.stringify(vocabulary));
            alert('âœ… ì „ì²´ ë‹¨ì–´ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!');
            updateVocabCount();
            renderAllWords();
            renderWords();
        }
    }
}

function updateVocabCount() {
    const count = vocabulary.length;
    const elem1 = document.getElementById('vocab-count-1');
    const elem2 = document.getElementById('vocab-count-2');
    if (elem1) elem1.textContent = count;
    if (elem2) elem2.textContent = count;
}

function showTab(tab) {
    ['learn', 'manage', 'settings'].forEach(t => {
        const content = document.getElementById('content-' + t);
        const tabBtn = document.getElementById('tab-' + t);
        if (t === tab) {
            content.classList.remove('hidden');
            tabBtn.classList.add('bg-white', 'text-indigo-600');
            tabBtn.classList.remove('text-gray-600');
        } else {
            content.classList.add('hidden');
            tabBtn.classList.remove('bg-white', 'text-indigo-600');
            tabBtn.classList.add('text-gray-600');
        }
    });
    if (tab === 'manage') {
        updateVocabCount();
        renderAllWords();
    }
}

function saveSettings() {
    localStorage.setItem('telegram-token', document.getElementById('telegram-token').value);
    localStorage.setItem('telegram-chatid', document.getElementById('telegram-chatid').value);
    alert('âœ… ì €ì¥ ì™„ë£Œ!');
}

function loadSettings() {
    const token = localStorage.getItem('telegram-token');
    const chatId = localStorage.getItem('telegram-chatid');
    if (token) document.getElementById('telegram-token').value = token;
    if (chatId) document.getElementById('telegram-chatid').value = chatId;
}

function addWord() {
    const english = document.getElementById('new-english').value.trim();
    const korean = document.getElementById('new-korean').value.trim();
    const synonymsText = document.getElementById('new-synonyms').value.trim();
    const example = document.getElementById('new-example').value.trim();
    
    if (!korean || !english || !example) {
        alert('âš ï¸ ì˜ì–´, í•œê¸€, ì˜ˆë¬¸ì€ í•„ìˆ˜ì…ë‹ˆë‹¤!');
        return;
    }
    
    const synonyms = synonymsText ? synonymsText.split(',').map(s => s.trim()).filter(s => s) : [];
    vocabulary.push({ korean, english, example, difficulty: 'basic', synonyms });
    localStorage.setItem('vocabulary', JSON.stringify(vocabulary));
    
    document.getElementById('new-english').value = '';
    document.getElementById('new-korean').value = '';
    document.getElementById('new-synonyms').value = '';
    document.getElementById('new-example').value = '';
    
    alert('âœ… ì¶”ê°€ ì™„ë£Œ!');
    updateVocabCount();
    renderAllWords();
    renderWords();
}

function renderWords() {
    const container = document.getElementById('word-list');
    const words = vocabulary.slice(0, 10);
    container.innerHTML = words.map((word, i) => `
        <div class="bg-white border rounded-xl shadow p-4">
            <div class="flex items-start gap-3">
                <div class="bg-indigo-100 text-indigo-600 font-bold w-8 h-8 rounded-full flex items-center justify-center text-sm">${i + 1}</div>
                <div class="flex-1">
                    <h3 class="text-lg font-bold">${word.korean}</h3>
                    <p class="text-indigo-600 font-semibold">${word.english}</p>
                    <p class="text-sm text-gray-600 italic mt-2">"${word.example}"</p>
                    ${word.synonyms && word.synonyms.length > 0 ? `
                        <div class="flex flex-wrap gap-1 mt-2">
                            ${word.synonyms.map(s => `<span class="px-2 py-1 bg-blue-50 text-blue-700 rounded text-xs">${s}</span>`).join('')}
                        </div>
                    ` : ''}
                </div>
            </div>
        </div>
    `).join('');
}

function renderAllWords() {
    const container = document.getElementById('all-words');
    container.innerHTML = `
        <div class="flex items-center justify-between mb-3">
            <h3 class="font-bold">ì „ì²´ ë‹¨ì–´ (${vocabulary.length}ê°œ)</h3>
            ${vocabulary.length > 0 ? `
                <button onclick="deleteAllWords()" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm">
                    ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ
                </button>
            ` : ''}
        </div>
    ` + (vocabulary.length > 0 ? vocabulary.map((w, i) => `
        <div class="flex items-center justify-between p-2 bg-gray-50 rounded mb-2">
            <div class="flex-1">
                <b>${w.korean}</b> â†’ ${w.english}
                ${w.synonyms && w.synonyms.length > 0 ? `<span class="text-xs text-gray-500 ml-2">(${w.synonyms.join(', ')})</span>` : ''}
            </div>
            <button onclick="deleteWord(${i})" class="text-red-500 hover:bg-red-50 p-1 rounded">ğŸ—‘ï¸</button>
        </div>
    `).join('') : '<p class="text-center text-gray-400 py-4">ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤</p>');
}

function deleteWord(index) {
    if (confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        vocabulary.splice(index, 1);
        localStorage.setItem('vocabulary', JSON.stringify(vocabulary));
        updateVocabCount();
        renderAllWords();
        renderWords();
    }
}

async function sendToTelegram() {
    let token = localStorage.getItem('telegram-token');
    const chatId = localStorage.getItem('telegram-chatid');
    if (!token || !chatId) {
        alert('âš ï¸ ì„¤ì • íƒ­ì—ì„œ í† í°ê³¼ Chat IDë¥¼ ë¨¼ì € ì…ë ¥í•˜ì„¸ìš”!');
        showTab('settings');
        return;
    }
    if (!token.startsWith('bot')) token = 'bot' + token;
    
    if (vocabulary.length === 0) {
        alert('âš ï¸ ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤! ë¨¼ì € ë‹¨ì–´ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.');
        return;
    }
    
    const words = vocabulary.slice(0, 10);
    const today = new Date().toLocaleDateString('ko-KR');
    let message = 'ğŸ“š <b>' + today + ' ì˜ì–´ í•™ìŠµ</b>\n\n';
    words.forEach((word, i) => {
        message += '<b>' + (i + 1) + '. ' + word.korean + '</b>\n   â¤ ' + word.english + '\n   ğŸ“ <i>' + word.example + '</i>\n\n';
    });
    message += 'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ’¡ ì˜¤ëŠ˜ë„ í™”ì´íŒ…! ğŸš€';
    try {
        const response = await fetch('https://api.telegram.org/' + token + '/sendMessage', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ chat_id: chatId, text: message, parse_mode: 'HTML' })
        });
        const result = await response.json();
        if (result.ok) {
            alert('âœ… í…”ë ˆê·¸ë¨ ì „ì†¡ ì™„ë£Œ!');
        } else {
            alert('âŒ ì „ì†¡ ì‹¤íŒ¨: ' + result.description);
        }
    } catch (error) {
        alert('âŒ ì˜¤ë¥˜: ' + error.message);
    }
}

window.onload = function() {
    loadSettings();
    const saved = localStorage.getItem('vocabulary');
    if (saved) vocabulary = JSON.parse(saved);
    updateVocabCount();
    renderWords();
    document.getElementById('today-date').textContent = new Date().toLocaleDateString('ko-KR', {
        year: 'numeric', month: 'long', day: 'numeric', weekday: 'long'
    });
};
</script>
</body>
</html>
